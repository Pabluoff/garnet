<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Notificações Web no iPhone</title>
    <link rel="manifest" href="/js/manifest.json">
    <style>
        button {
            display: block;
            margin: 20px;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>

</head>
<body>
    <button onclick="solicitarPermissao()">Solicitar permissão para notificações</button>
    
    <script>
        function solicitarPermissao() {
            if (!("Notification" in window)) {
                alert("Este navegador não suporta notificações.");
                return;
            }

            Notification.requestPermission().then(function(permission) {
                if (permission === "granted") {
                    alert("Permissão concedida!");
                } else {
                    alert("Permissão negada.");
                }
            });
        }

        if ('serviceWorker' in navigator && 'PushManager' in window) {
            navigator.serviceWorker.register('sw.js')
                .then(function(swReg) {
                    console.log('Service Worker registrado com sucesso:', swReg);

                    Notification.requestPermission().then(function(permission) {
                        if (permission === 'granted') {
                            console.log('Permissão concedida para notificações.');
                            // Agendar notificações diárias
                            agendarNotificacaoDiaria(swReg);
                        } else {
                            console.log('Permissão negada para notificações.');
                        }
                    });
                })
                .catch(function(error) {
                    console.error('Erro ao registrar o Service Worker:', error);
                });
        } else {
            console.warn('Service Worker ou Push Manager não são suportados neste navegador.');
        }

        function agendarNotificacaoDiaria(swReg) {
            // Use um intervalo para simular notificações diárias
            setInterval(() => {
                const titulo = 'Notificação Diária';
                const opcoes = {
                    body: 'Esta é uma notificação enviada automaticamente uma vez por dia.',
                    icon: '/img/logo.jpg' // Caminho para um ícone opcional
                };

                swReg.showNotification(titulo, opcoes);
            }, 24 * 60 * 60 * 1000); // 24 horas em milissegundos
        }
    </script>
</body>
</html>
